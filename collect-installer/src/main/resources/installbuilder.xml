<project>
	<shortName>OpenForisCollect</shortName>
	<fullName>Open Foris Collect</fullName>
	<version>PROJECT_VERSION</version>

	<!-- <readmeFile>../../../README</readmeFile> <licenseFile>../../../../License.txt</licenseFile> -->
	<logoImage>images/of-logo-small.png</logoImage>
	<componentList>
		<component>
			<name>default</name>
			<description>Default Component</description>
			<canBeEdited>1</canBeEdited>
			<selected>1</selected>
			<show>1</show>
			<desktopShortcutList>
				<shortcut>
					<name>Startup Open Foris Collect</name>
					<comment>Startup Open Foris Collect</comment>
					<exec>${installdir}/startup-linux.sh</exec>
					<path>${installdir}</path>
					<icon>${installdir}/images/of-logo.png</icon>
					<platforms>linux</platforms>
					<runAsAdmin>0</runAsAdmin>
					<runInTerminal>0</runInTerminal>
					<windowsExec></windowsExec>
					<windowsExecArgs></windowsExecArgs>
					<windowsIcon></windowsIcon>
					<windowsPath></windowsPath>
				</shortcut>
				<shortcut>
					<name>Shutdown Open Foris Collect</name>
					<comment>Shutdown Open Foris Collect</comment>
					<exec>${installdir}/shutdown-linux.sh</exec>
					<path>${installdir}</path>
					<icon>${installdir}/images/of-logo.png</icon>
					<platforms>linux</platforms>
					<runAsAdmin>0</runAsAdmin>
					<runInTerminal>0</runInTerminal>
					<windowsExec></windowsExec>
					<windowsExecArgs></windowsExecArgs>
					<windowsIcon></windowsIcon>
					<windowsPath></windowsPath>
				</shortcut>
			</desktopShortcutList>
			<folderList>
				<folder>
					<description>Program Files</description>
					<destination>${installdir}</destination>
					<name>programfiles</name>
					<platforms>all</platforms>
					<distributionFileList>
						<!-- <distributionFile> <origin>../../../../collect-control-panel/target/OpenForisCollect.jar</origin> 
							</distributionFile> -->
						<distributionDirectory>
							<origin>collect-server/tomcat</origin>
						</distributionDirectory>
						<distributionFile>
							<origin>startup-linux.sh</origin>
						</distributionFile>
						<distributionFile>
							<origin>shutdown-linux.sh</origin>
						</distributionFile>
						<distributionFile>
							<origin>startup-windows.cmd</origin>
						</distributionFile>
						<distributionFile>
							<origin>shutdown-windows.cmd</origin>
						</distributionFile>
						<distributionFile>
							<allowWildcards>1</allowWildcards>
							<origin>images</origin>
						</distributionFile>
					</distributionFileList>
					<shortcutList>
						<shortcut>
							<comment>Uninstall</comment>
							<exec>${installdir}/${uninstallerName}</exec>
							<icon></icon>
							<name>Uninstall ${product_fullname}</name>
							<path>${installdir}</path>
							<platforms>all</platforms>
							<runAsAdmin>0</runAsAdmin>
							<runInTerminal>0</runInTerminal>
							<windowsExec>${installdir}/${uninstallerName}.exe</windowsExec>
							<windowsExecArgs></windowsExecArgs>
							<windowsIcon></windowsIcon>
							<windowsPath>${installdir}</windowsPath>
						</shortcut>
					</shortcutList>
				</folder>
			</folderList>
			<startMenuShortcutList>
				<startMenuShortcut>
					<comment>Uninstall ${product_fullname}</comment>
					<name>Uninstall ${product_fullname}</name>
					<runAsAdmin>0</runAsAdmin>
					<runInTerminal>0</runInTerminal>
					<windowsExec>${installdir}/${uninstallerName}.exe</windowsExec>
					<windowsExecArgs></windowsExecArgs>
					<windowsIcon></windowsIcon>
					<windowsPath>${installdir}/</windowsPath>
				</startMenuShortcut>
				<startMenuShortcut>
					<comment>Startup Open Foris Collect</comment>
					<name>Startup OF Collect</name>
					<runAsAdmin>0</runAsAdmin>
					<runInTerminal>0</runInTerminal>
					<windowsExec>${installdir}/startup-windows.cmd</windowsExec>
					<windowsExecArgs></windowsExecArgs>
					<windowsIcon>${installdir}/images/of-logo-small-ico.ico
					</windowsIcon>
					<windowsPath></windowsPath>
				</startMenuShortcut>
				<startMenuShortcut>
					<comment>Shutdown Open Foris Collect</comment>
					<name>Shutdown OF Collect</name>
					<runAsAdmin>0</runAsAdmin>
					<runInTerminal>0</runInTerminal>
					<windowsExec>${installdir}/shutdown-windows.cmd</windowsExec>
					<windowsExecArgs></windowsExecArgs>
					<windowsIcon>${installdir}/images/of-logo-small-ico.ico
					</windowsIcon>
					<windowsPath></windowsPath>
				</startMenuShortcut>
				<startMenuLinkShortcut>
					<comment>Open your default browser</comment>
					<name>Open OF Collect in browser </name>
					<runAsAdmin>0</runAsAdmin>
					<runInTerminal>0</runInTerminal>
					<url>http://localhost:8080/collect</url>
					<windowsIcon>${installdir}/images/browser.ico</windowsIcon>
				</startMenuLinkShortcut>
			</startMenuShortcutList>
		</component>
		<component>
			<name>autoupdater</name>
			<description>includes tool to perform updates</description>
			<canBeEdited>0</canBeEdited>
			<selected>1</selected>
			<show>0</show>
			<folderList>
				<folder>
					<name>autoupdaterwin</name>
					<destination>${installdir}</destination>
					<platforms>windows</platforms>
					<distributionFileList>
						<distributionFile origin="autoupdate-windows.exe" />
					</distributionFileList>
				</folder>
				<folder>
					<name>autoupdaterlinux</name>
					<destination>${installdir}</destination>
					<platforms>linux</platforms>
					<distributionFileList>
						<distributionFile origin="autoupdate-linux.run" />
					</distributionFileList>
				</folder>
			</folderList>
			<postInstallationActionList>
				<writeFile>
					<path>${installdir}/update.ini</path>
					<text>[Update]
						url = UPDATE_XML_URL
						version_id = PROJECT_VERSION
						update_download_location = ${system_temp_directory}
						check_for_updates = 1
					</text>
				</writeFile>
			</postInstallationActionList>
		</component>
		<include>
			<file>java.xml</file>
		</include>
	</componentList>
	<preInstallationActionList>
		<setInstallerVariable>
			<name>installdir</name>
			<value>${env(SYSTEMDRIVE)}/opt/openforis/collect</value>
		</setInstallerVariable>
	</preInstallationActionList>
	<postInstallationActionList>
		<!-- <addEnvironmentVariable> <name>COLLECT_HOME</name> <scope>system</scope> 
			<value>${installdir}</value> </addEnvironmentVariable> -->
		<changePermissions>
			<files>${installdir}/*.sh</files>
			<permissions>0555</permissions>
		</changePermissions>
		<substitute>
			<files>${installdir}/startup-linux.sh;${installdir}/shutdown-linux.sh;${installdir}/startup-windows.cmd;${installdir}/shutdown-windows.cmd;</files>
			<type>exact</type>
			<substitutionList>
				<substitution>
					<pattern>install_directory</pattern>
					<value>${installdir}</value>
				</substitution>
			</substitutionList>
		</substitute>
		<changeOwnerAndGroup>
			<files>/home/${env(SUDO_USER)}/Desktop/${java_launcher_binary_name}
			</files>
			<group></group>
			<owner>${env(SUDO_USER)}</owner>
			<ruleList>
				<platformTest>
					<type>linux</type>
				</platformTest>
			</ruleList>
		</changeOwnerAndGroup>
	</postInstallationActionList>
	<postUninstallationActionList>
		<deleteFile>
			<path>${installdir}</path>
		</deleteFile>
		<deleteFile>
			<path>${project.rollbackBackupDirectory}</path>
		</deleteFile>
	</postUninstallationActionList>
	<compressionAlgorithm>lzma-ultra</compressionAlgorithm>
	<defaultUnixDirectoryPermissions>777</defaultUnixDirectoryPermissions>
	<defaultUnixFilePermissions>777</defaultUnixFilePermissions>
	<defaultUnixOwner>${env(SUDO_USER)}</defaultUnixOwner>
	<enableRollback>1</enableRollback>
	<enableTimestamp>1</enableTimestamp>
	<rebootRequired>0</rebootRequired>
	<requireInstallationByRootUser>1</requireInstallationByRootUser>
	<rollbackBackupDirectory>${system_temp_directory}/${product_shortname}/backup
	</rollbackBackupDirectory>
	<saveRelativePaths>1</saveRelativePaths>
	<vendor>Open Foris</vendor>
	<parameterList>
		<directoryParameter>
			<name>installdir</name>
			<description>Installer.Parameter.installdir.description</description>
			<explanation>Installer.Parameter.installdir.explanation</explanation>
			<value></value>
			<default>${platform_install_prefix}/${product_shortname}</default>
			<allowEmptyValue>0</allowEmptyValue>
			<cliOptionName>prefix</cliOptionName>
			<mustBeWritable>1</mustBeWritable>
			<mustExist>0</mustExist>
			<width>30</width>
		</directoryParameter>
	</parameterList>
</project>

